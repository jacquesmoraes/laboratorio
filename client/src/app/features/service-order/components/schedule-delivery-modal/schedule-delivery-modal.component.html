<div class="modal-container">
  <h2>{{ isEditMode ? 'Editar Agendamento' : 'Agendar Entrega' }}</h2>

  @if (loading()) {
    <div class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Carregando...</p>
    </div>
  }

  @if (!loading()) {
    <form [formGroup]="form" (ngSubmit)="submit()">
      <div class="form-group">
        <label for="scheduledDate">Data:</label>
        <input
          id="scheduledDate"
          type="date"
          formControlName="scheduledDate"
          class="form-control"
        />
      </div>

      <div class="form-group">
        <label for="deliveryType">Tipo de entrega:</label>
        <select
          id="deliveryType"
          formControlName="deliveryType"
          class="form-control"
        >
          @for (type of deliveryTypes; track type) {
            <option [value]="type">{{ type }}</option>
          }
        </select>
      </div>

      @if (showSector()) {
        <div class="form-group">
          <label for="sectorId">Setor destino:</label>
          <select
            id="sectorId"
            formControlName="sectorId"
            class="form-control"
          >
            @for (sector of sectors; track sector.sectorId) {
              <option [value]="sector.sectorId">
                {{ sector.sectorName }}
              </option>
            }
          </select>
        </div>
      }

      <div class="actions">
        <button
          mat-button
          type="submit"
          [disabled]="form.invalid || loading()"
          class="btn-primary"
        >
          @if (loading()) {
            <mat-spinner diameter="20"></mat-spinner>
          } @else {
            {{ isEditMode ? 'Atualizar' : 'Agendar' }}
          }
        </button>

        <button
          mat-button
          type="button"
          (click)="cancel()"
          [disabled]="loading()"
          class="btn-secondary"
        >
          Cancelar
        </button>
      </div>
    </form>
  }
</div>