<div class="complete-first-access-container">
  <mat-card class="complete-first-access-card">
    <mat-card-header>
      <mat-card-title>Primeiro Acesso</mat-card-title>
      <mat-card-subtitle>Defina sua senha para completar o cadastro</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div class="info-section">
        <mat-icon class="info-icon">info</mat-icon>
        <p>Você recebeu um código de acesso por email. Use-o para definir sua senha.</p>
      </div>

      <form (ngSubmit)="onSubmit()" class="complete-form">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Email</mat-label>
          <input matInput type="email" [(ngModel)]="formData().email" name="email" required [disabled]="loading()"
            readonly />
          <mat-icon matSuffix>email</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Código de Acesso</mat-label>
          <input matInput [(ngModel)]="formData().accessCode" name="accessCode" required [disabled]="loading()"
            placeholder="Digite o código recebido" />
          <mat-icon matSuffix>key</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Nova Senha</mat-label>
          <input matInput type="password" [(ngModel)]="formData().newPassword" name="newPassword" required
            [disabled]="loading()" placeholder="Mínimo 6 caracteres" />
          <mat-icon matSuffix>lock</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Confirmar Nova Senha</mat-label>
          <input matInput type="password" [(ngModel)]="formData().confirmNewPassword" name="confirmNewPassword" required
            [disabled]="loading()" placeholder="Confirme a nova senha" />
          <mat-icon matSuffix>lock_reset</mat-icon>
        </mat-form-field>

        @if (error()) {
        <div class="error-message">
          <mat-icon>error</mat-icon>
          <span>{{ error() }}</span>
        </div>
        }

        <button mat-raised-button color="primary" type="submit" class="full-width" [disabled]="loading()">
          @if (loading()) {
          <mat-spinner diameter="20"></mat-spinner>
          <span>Completando...</span>
          } @else {
          <ng-container>
            <mat-icon>check_circle</mat-icon>
            <span>Completar Cadastro</span>
          </ng-container>

          }
        </button>
      </form>
    </mat-card-content>
  </mat-card>
</div>
